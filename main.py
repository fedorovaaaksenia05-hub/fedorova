import telebot
import random

from config import API_KEY

bot = telebot.TeleBot(API_KEY)

# –§–∏–ª—å–º—ã –ø–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è–º
movies = {
    '–ø–æ–ø–ª–∞–∫–∞—Ç—å': ["1+1", "–ó–µ–ª–µ–Ω–∞—è –∫–Ω–∏–≥–∞", "–•–∞—Ç–∏–∫–æ", "–§–æ—Ä—Ä–µ—Å—Ç –ì–∞–º–ø", "–ü–æ–±–µ–≥ –∏–∑ –®–æ—É—à–µ–Ω–∫–∞", "–°–ø–∏—Å–æ–∫ –®–∏–Ω–¥–ª–µ—Ä–∞"],
    '–ø–æ—Å–º–µ—è—Ç—å—Å—è': ["–û–¥–Ω–∏ –¥–æ–º–∞", "–ò–≤–∞–Ω –í–∞—Å–∏–ª—å–µ–≤–∏—á", "–ë—Ä–∏–ª–ª–∏–∞–Ω—Ç–æ–≤–∞—è —Ä—É–∫–∞", "–ú–∞–ª—å—á–∏—à–Ω–∏–∫ –≤ –í–µ–≥–∞—Å–µ", "–û–ø–µ—Ä–∞—Ü–∏—è –´",
                   "–î–∂–µ–Ω—Ç–µ–ª—å–º–µ–Ω—ã —É–¥–∞—á–∏"],
    '–ø–æ–Ω–æ—Å—Ç–∞–ª—å–≥–∏—Ä–æ–≤–∞—Ç—å': ["–ù–∞–∑–∞–¥ –≤ –±—É–¥—É—â–µ–µ", "–¢–∏—Ç–∞–Ω–∏–∫", "–ì–∞—Ä—Ä–∏ –ü–æ—Ç—Ç–µ—Ä", "–ö–æ—Ä–æ–ª—å –õ–µ–≤", "–í–ª–∞—Å—Ç–µ–ª–∏–Ω –∫–æ–ª–µ—Ü", "–ú–∞—Ç—Ä–∏—Ü–∞"],
    '–ø–æ—Ä–∞–¥–æ–≤–∞—Ç—å—Å—è': ["–û—Ç–ø—É—Å–∫ –ø–æ –æ–±–º–µ–Ω—É", "–í –ø–æ–≥–æ–Ω–µ –∑–∞ —Å—á–∞—Å—Ç—å–µ–º", "–ê–º–µ–ª–∏", "–ö—Ä—É–ø–Ω–∞—è —Ä—ã–±–∞", "–ü–æ–ª–ª–∏–∞–Ω–Ω–∞", "–ú–∞—Ä–ª–∏ –∏ —è"]
}

# –•—Ä–∞–Ω–∏–º –ø–æ—Å–ª–µ–¥–Ω–µ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
user_moods = {}


# –°—Ç–∞—Ä—Ç –±–æ—Ç–∞
@bot.message_handler(commands=['start'])
def start(message):
    text = "–ü—Ä–∏–≤–µ—Ç! –ù–∞–ø–∏—à–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ: –ø–æ–ø–ª–∞–∫–∞—Ç—å, –ø–æ—Å–º–µ—è—Ç—å—Å—è, –ø–æ–Ω–æ—Å—Ç–∞–ª—å–≥–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ –ø–æ—Ä–∞–¥–æ–≤–∞—Ç—å—Å—è"
    bot.send_message(message.chat.id, text)


# –ü–æ–º–æ—â—å
@bot.message_handler(commands=['help'])
def help(message):
    text = "–ü—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏ —Å–≤–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏ —è –ø–æ–¥–±–µ—Ä—É —Ñ–∏–ª—å–º! –ü–æ—Å–ª–µ –º–æ–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å '–∞ –µ—â–µ' –¥–ª—è –¥—Ä—É–≥–æ–≥–æ —Ñ–∏–ª—å–º–∞"
    bot.send_message(message.chat.id, text)


# –û —Å–æ–∑–¥–∞—Ç–µ–ª–µ
@bot.message_handler(commands=['about'])
def about(message):
    bot.send_message(message.chat.id, "–ë–æ—Ç —Å–¥–µ–ª–∞–Ω –ö—Å—é –∏–∑ –≥—Ä—É–ø–ø—ã 8341")


# –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
@bot.message_handler(content_types=['text'])
def handle_text(message):
    text = message.text.lower()
    user_id = message.chat.id

    # –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç "–∞ –µ—â–µ" –∏–ª–∏ "–∞ –µ—â–µ?"
    if text in ['–∞ –µ—â–µ', '–∞ –µ—â–µ?']:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –¥–ª—è —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        if user_id in user_moods:
            mood = user_moods[user_id]
            films = movies[mood]
            film = random.choice(films)
            response = f"üé¨ –ï—â–µ –æ–¥–∏–Ω —Ñ–∏–ª—å–º –¥–ª—è '{mood}':\n\n{film}\n\n–ù–∞–ø–∏—à–∏ '–∞ –µ—â–µ' –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ñ–∏–ª—å–º–∞!"
        else:
            response = "–°–Ω–∞—á–∞–ª–∞ –Ω–∞–ø–∏—à–∏ —Å–≤–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ üòä"

    # –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ
    elif text in movies:
        mood = text
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        user_moods[user_id] = mood
        films = movies[mood]
        film = random.choice(films)
        response = f"üé¨ –î–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è '{mood}' —Å–º–æ—Ç—Ä–∏:\n\n{film}\n\n–ù–∞–ø–∏—à–∏ '–∞ –µ—â–µ' –¥–ª—è –¥—Ä—É–≥–æ–≥–æ —Ñ–∏–ª—å–º–∞! üçø"

    # –ï—Å–ª–∏ –Ω–µ–ø–æ–Ω—è—Ç–Ω—ã–π –∑–∞–ø—Ä–æ—Å
    else:
        response = "–ù–µ –ø–æ–Ω—è–ª üòî –ù–∞–ø–∏—à–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏–ª–∏ '–∞ –µ—â–µ' –µ—Å–ª–∏ —É–∂–µ –≤—ã–±–∏—Ä–∞–ª —Ñ–∏–ª—å–º"

    bot.send_message(message.chat.id, response)


# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
bot.polling()